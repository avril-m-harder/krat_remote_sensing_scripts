dev.off()
## single page
pdf('/Users/Avril/Desktop/vars_across_days_with_offset_singlepage.pdf', width = 6.5, height = 9)
par(mar = c(4.1, 4.1, 0.1, 0.1), mfrow = c(4,1))
k <- 1
txt.size <- 1.25
y.names <- c('Greenness','Wetness','Brightness','Surface temperature (deg C)')
for(c in c(2:4,10)){
OUT <- NULL
for(y in unique(occ.dat$off.year)){
sub <- occ.dat[occ.dat$off.year == y,]
for(d in sort(unique(sub$off.doy))){
save <- c(y, d, mean(sub[sub$off.doy == d, c]), sd(sub[sub$off.doy == d, c]))
OUT <- rbind(OUT, save)
}
par(xpd = FALSE)
if(k < 4){
plot(0,0, xlim = c(0,386), ylim = c(min(OUT[,3] - OUT[,4]), max(OUT[,3] + OUT[,4])), col = 'transparent',
xlab = '', ylab = y.names[k], main = '', xaxt = 'n', cex.lab = txt.size, cex.axis = txt.size)
} else{
plot(0,0, xlim = c(0,386), ylim = c(min(OUT[,3] - OUT[,4]), max(OUT[,3] + OUT[,4])), col = 'transparent',
xlab = 'Day of year', ylab = y.names[k], main = '', xaxt = 'n', cex.lab = txt.size, cex.axis = txt.size)
}
axis(1, at = c(1, 154, 275), labels = c('July 1','December 1','April 1'), cex.lab = txt.size, cex.axis = txt.size)
polygon(x = c(154, 274, 274, 154), y = c(-10, -10, 100, 100), border = NA, col = w.rain)
polygon(x = c(1, 62, 62, 1), y = c(-10, -10, 100, 100), border = NA, col = s.rain)
for(y in unique(OUT[,1])){
sub <- OUT[OUT[,1] == y,]
lower <- sub[,3]-sub[,4]
upper <- sub[,3]+sub[,4]
if(k == 4){
polygon(c(sub[c(1:nrow(sub)),2], sub[c(nrow(sub):1),2]), c(lower, upper[length(upper):1]),
border = NA, col = alpha(colours[k], 0.4))
} else{
polygon(c(sub[c(1:nrow(sub)),2], sub[c(nrow(sub):1),2]), c(lower, upper[length(upper):1]),
border = NA, col = alpha(colours[k], 0.2))
}
for(y in unique(OUT[,1])){
sub <- OUT[OUT[,1] == y,]
lower <- sub[,3]-sub[,4]
upper <- sub[,3]+sub[,4]
lines(sub[,2], sub[,3], col = 'white')
points(sub[,2], sub[,3], col = 'white', cex = 0.6, pch = 19)
points(372, mean(sub[,3]), pch = 19, col = alpha(colours[k], 0.7), cex = 1.2)
points(383, mean(sub[which(sub[,2] >= 335 | sub[,2] <= 90),3]), pch = 15, col = alpha(colours[k], 0.7), cex = 1.2)
points(394, mean(sub[which(sub[,2] >= 182 & sub[,2] <= 243),3]), pch = 17, col = alpha(colours[k], 0.7), cex = 1.2)
}
# par(xpd = TRUE)
# legend('topright', pch = c(17,15,19), col = alpha(colours[k], 0.7), bty = 'n',
#        legend = c('Summer rainy', 'Winter rainy', 'Annual'), inset = -.2,
#        title = 'Means')
# legend('bottomright', fill = c(s.rain, w.rain), legend = c('Summer rainy','Winter rainy'),
#        bty = 'n', title = 'Seasons', border = NA, inset = -.2)
k <- k+1
}
dev.off()
# par(xpd = TRUE)
# legend('topright', pch = c(17,15,19), col = alpha(colours[k], 0.7), bty = 'n',
#        legend = c('Summer rainy', 'Winter rainy', 'Annual'), inset = -.2,
#        title = 'Means')
# legend('bottomright', fill = c(s.rain, w.rain), legend = c('Summer rainy','Winter rainy'),
#        bty = 'n', title = 'Seasons', border = NA, inset = -.2)
abline(v = 368.5, lty = 2)
## single page
pdf('/Users/Avril/Desktop/vars_across_days_with_offset_singlepage.pdf', width = 6.5, height = 9)
par(mar = c(4.1, 4.1, 0.1, 0.1), mfrow = c(4,1))
k <- 1
txt.size <- 1.25
y.names <- c('Greenness','Wetness','Brightness','Surface temperature (deg C)')
for(c in c(2:4,10)){
OUT <- NULL
for(y in unique(occ.dat$off.year)){
sub <- occ.dat[occ.dat$off.year == y,]
for(d in sort(unique(sub$off.doy))){
save <- c(y, d, mean(sub[sub$off.doy == d, c]), sd(sub[sub$off.doy == d, c]))
OUT <- rbind(OUT, save)
}
par(xpd = FALSE)
if(k < 4){
plot(0,0, xlim = c(0,386), ylim = c(min(OUT[,3] - OUT[,4]), max(OUT[,3] + OUT[,4])), col = 'transparent',
xlab = '', ylab = y.names[k], main = '', xaxt = 'n', cex.lab = txt.size, cex.axis = txt.size)
} else{
plot(0,0, xlim = c(0,386), ylim = c(min(OUT[,3] - OUT[,4]), max(OUT[,3] + OUT[,4])), col = 'transparent',
xlab = 'Day of year', ylab = y.names[k], main = '', xaxt = 'n', cex.lab = txt.size, cex.axis = txt.size)
}
axis(1, at = c(1, 154, 275), labels = c('July 1','December 1','April 1'), cex.lab = txt.size, cex.axis = txt.size)
polygon(x = c(154, 274, 274, 154), y = c(-10, -10, 100, 100), border = NA, col = w.rain)
polygon(x = c(1, 62, 62, 1), y = c(-10, -10, 100, 100), border = NA, col = s.rain)
for(y in unique(OUT[,1])){
sub <- OUT[OUT[,1] == y,]
lower <- sub[,3]-sub[,4]
upper <- sub[,3]+sub[,4]
if(k == 4){
polygon(c(sub[c(1:nrow(sub)),2], sub[c(nrow(sub):1),2]), c(lower, upper[length(upper):1]),
border = NA, col = alpha(colours[k], 0.4))
} else{
polygon(c(sub[c(1:nrow(sub)),2], sub[c(nrow(sub):1),2]), c(lower, upper[length(upper):1]),
border = NA, col = alpha(colours[k], 0.2))
}
for(y in unique(OUT[,1])){
sub <- OUT[OUT[,1] == y,]
lower <- sub[,3]-sub[,4]
upper <- sub[,3]+sub[,4]
lines(sub[,2], sub[,3], col = 'white')
points(sub[,2], sub[,3], col = 'white', cex = 0.6, pch = 19)
points(372, mean(sub[,3]), pch = 19, col = alpha(colours[k], 0.7), cex = 1.2)
points(383, mean(sub[which(sub[,2] >= 335 | sub[,2] <= 90),3]), pch = 15, col = alpha(colours[k], 0.7), cex = 1.2)
points(394, mean(sub[which(sub[,2] >= 182 & sub[,2] <= 243),3]), pch = 17, col = alpha(colours[k], 0.7), cex = 1.2)
}
# par(xpd = TRUE)
# legend('topright', pch = c(17,15,19), col = alpha(colours[k], 0.7), bty = 'n',
#        legend = c('Summer rainy', 'Winter rainy', 'Annual'), inset = -.2,
#        title = 'Means')
# legend('bottomright', fill = c(s.rain, w.rain), legend = c('Summer rainy','Winter rainy'),
#        bty = 'n', title = 'Seasons', border = NA, inset = -.2)
abline(v = 368.5, lty = 2)
k <- k+1
}
dev.off()
## single page
pdf('/Users/Avril/Desktop/vars_across_days_with_offset_singlepage.pdf', width = 6.5, height = 9)
par(mar = c(4.1, 4.1, 0.1, 0.1), mfrow = c(4,1))
k <- 1
txt.size <- 1.25
y.names <- c('Greenness','Wetness','Brightness','Surface temperature (deg C)')
for(c in c(2:4,10)){
OUT <- NULL
for(y in unique(occ.dat$off.year)){
sub <- occ.dat[occ.dat$off.year == y,]
for(d in sort(unique(sub$off.doy))){
save <- c(y, d, mean(sub[sub$off.doy == d, c]), sd(sub[sub$off.doy == d, c]))
OUT <- rbind(OUT, save)
}
par(xpd = FALSE)
if(k < 4){
plot(0,0, xlim = c(0,386), ylim = c(min(OUT[,3] - OUT[,4]), max(OUT[,3] + OUT[,4])), col = 'transparent',
xlab = '', ylab = y.names[k], main = '', xaxt = 'n', cex.lab = txt.size, cex.axis = txt.size)
} else{
plot(0,0, xlim = c(0,386), ylim = c(min(OUT[,3] - OUT[,4]), max(OUT[,3] + OUT[,4])), col = 'transparent',
xlab = 'Day of year', ylab = y.names[k], main = '', xaxt = 'n', cex.lab = txt.size, cex.axis = txt.size)
}
axis(1, at = c(1, 154, 275), labels = c('July 1','December 1','April 1'), cex.lab = txt.size, cex.axis = txt.size)
polygon(x = c(154, 274, 274, 154), y = c(-10, -10, 100, 100), border = NA, col = w.rain)
polygon(x = c(1, 62, 62, 1), y = c(-10, -10, 100, 100), border = NA, col = s.rain)
for(y in unique(OUT[,1])){
sub <- OUT[OUT[,1] == y,]
lower <- sub[,3]-sub[,4]
upper <- sub[,3]+sub[,4]
if(k == 4){
polygon(c(sub[c(1:nrow(sub)),2], sub[c(nrow(sub):1),2]), c(lower, upper[length(upper):1]),
border = NA, col = alpha(colours[k], 0.4))
} else{
polygon(c(sub[c(1:nrow(sub)),2], sub[c(nrow(sub):1),2]), c(lower, upper[length(upper):1]),
border = NA, col = alpha(colours[k], 0.2))
}
for(y in unique(OUT[,1])){
sub <- OUT[OUT[,1] == y,]
lower <- sub[,3]-sub[,4]
upper <- sub[,3]+sub[,4]
lines(sub[,2], sub[,3], col = 'white')
points(sub[,2], sub[,3], col = 'white', cex = 0.6, pch = 19)
points(372, mean(sub[,3]), pch = 19, col = alpha(colours[k], 0.7), cex = 1.2)
points(383, mean(sub[which(sub[,2] >= 335 | sub[,2] <= 90),3]), pch = 15, col = alpha(colours[k], 0.7), cex = 1.2)
points(394, mean(sub[which(sub[,2] >= 182 & sub[,2] <= 243),3]), pch = 17, col = alpha(colours[k], 0.7), cex = 1.2)
}
# par(xpd = TRUE)
# legend('topright', pch = c(17,15,19), col = alpha(colours[k], 0.7), bty = 'n',
#        legend = c('Summer rainy', 'Winter rainy', 'Annual'), inset = -.2,
#        title = 'Means')
# legend('bottomright', fill = c(s.rain, w.rain), legend = c('Summer rainy','Winter rainy'),
#        bty = 'n', title = 'Seasons', border = NA, inset = -.2)
abline(v = 367.5, lty = 2)
k <- k+1
}
dev.off()
## single page
pdf('/Users/Avril/Desktop/vars_across_days_with_offset_singlepage.pdf', width = 6.5, height = 9)
par(mar = c(3.1, 4.1, 0.1, 0.1), mfrow = c(4,1))
k <- 1
txt.size <- 1.2
y.names <- c('Greenness','Wetness','Brightness','Surface temperature (deg C)')
for(c in c(2:4,10)){
OUT <- NULL
for(y in unique(occ.dat$off.year)){
sub <- occ.dat[occ.dat$off.year == y,]
for(d in sort(unique(sub$off.doy))){
save <- c(y, d, mean(sub[sub$off.doy == d, c]), sd(sub[sub$off.doy == d, c]))
OUT <- rbind(OUT, save)
}
par(xpd = FALSE)
if(k < 4){
plot(0,0, xlim = c(0,386), ylim = c(min(OUT[,3] - OUT[,4]), max(OUT[,3] + OUT[,4])), col = 'transparent',
xlab = '', ylab = y.names[k], main = '', xaxt = 'n', cex.lab = txt.size, cex.axis = txt.size)
} else{
plot(0,0, xlim = c(0,386), ylim = c(min(OUT[,3] - OUT[,4]), max(OUT[,3] + OUT[,4])), col = 'transparent',
xlab = '', ylab = y.names[k], main = '', xaxt = 'n', cex.lab = txt.size, cex.axis = txt.size)
}
axis(1, at = c(1, 154, 275), labels = c('July 1','December 1','April 1'), cex.lab = txt.size, cex.axis = txt.size)
polygon(x = c(154, 274, 274, 154), y = c(-10, -10, 100, 100), border = NA, col = w.rain)
polygon(x = c(1, 62, 62, 1), y = c(-10, -10, 100, 100), border = NA, col = s.rain)
for(y in unique(OUT[,1])){
sub <- OUT[OUT[,1] == y,]
lower <- sub[,3]-sub[,4]
upper <- sub[,3]+sub[,4]
if(k == 4){
polygon(c(sub[c(1:nrow(sub)),2], sub[c(nrow(sub):1),2]), c(lower, upper[length(upper):1]),
border = NA, col = alpha(colours[k], 0.4))
} else{
polygon(c(sub[c(1:nrow(sub)),2], sub[c(nrow(sub):1),2]), c(lower, upper[length(upper):1]),
border = NA, col = alpha(colours[k], 0.2))
}
for(y in unique(OUT[,1])){
sub <- OUT[OUT[,1] == y,]
lower <- sub[,3]-sub[,4]
upper <- sub[,3]+sub[,4]
lines(sub[,2], sub[,3], col = 'white')
points(sub[,2], sub[,3], col = 'white', cex = 0.6, pch = 19)
points(372, mean(sub[,3]), pch = 19, col = alpha(colours[k], 0.7), cex = 1.2)
points(383, mean(sub[which(sub[,2] >= 335 | sub[,2] <= 90),3]), pch = 15, col = alpha(colours[k], 0.7), cex = 1.2)
points(394, mean(sub[which(sub[,2] >= 182 & sub[,2] <= 243),3]), pch = 17, col = alpha(colours[k], 0.7), cex = 1.2)
}
# par(xpd = TRUE)
# legend('topright', pch = c(17,15,19), col = alpha(colours[k], 0.7), bty = 'n',
#        legend = c('Summer rainy', 'Winter rainy', 'Annual'), inset = -.2,
#        title = 'Means')
# legend('bottomright', fill = c(s.rain, w.rain), legend = c('Summer rainy','Winter rainy'),
#        bty = 'n', title = 'Seasons', border = NA, inset = -.2)
abline(v = 367.5, lty = 2)
k <- k+1
}
dev.off()
## single page
pdf('/Users/Avril/Desktop/vars_across_days_with_offset_singlepage.pdf', width = 6.5, height = 9)
par(mar = c(3.1, 4.1, 0.1, 0.1), mfrow = c(4,1))
k <- 1
txt.size <- 1.1
y.names <- c('Greenness','Wetness','Brightness','Surface temperature (deg C)')
for(c in c(2:4,10)){
OUT <- NULL
for(y in unique(occ.dat$off.year)){
sub <- occ.dat[occ.dat$off.year == y,]
for(d in sort(unique(sub$off.doy))){
save <- c(y, d, mean(sub[sub$off.doy == d, c]), sd(sub[sub$off.doy == d, c]))
OUT <- rbind(OUT, save)
}
par(xpd = FALSE)
if(k < 4){
plot(0,0, xlim = c(0,386), ylim = c(min(OUT[,3] - OUT[,4]), max(OUT[,3] + OUT[,4])), col = 'transparent',
xlab = '', ylab = y.names[k], main = '', xaxt = 'n', cex.lab = txt.size, cex.axis = txt.size)
} else{
plot(0,0, xlim = c(0,386), ylim = c(min(OUT[,3] - OUT[,4]), max(OUT[,3] + OUT[,4])), col = 'transparent',
xlab = '', ylab = y.names[k], main = '', xaxt = 'n', cex.lab = txt.size, cex.axis = txt.size)
}
axis(1, at = c(1, 154, 275), labels = c('July 1','December 1','April 1'), cex.lab = txt.size, cex.axis = txt.size)
polygon(x = c(154, 274, 274, 154), y = c(-10, -10, 100, 100), border = NA, col = w.rain)
polygon(x = c(1, 62, 62, 1), y = c(-10, -10, 100, 100), border = NA, col = s.rain)
for(y in unique(OUT[,1])){
sub <- OUT[OUT[,1] == y,]
lower <- sub[,3]-sub[,4]
upper <- sub[,3]+sub[,4]
if(k == 4){
polygon(c(sub[c(1:nrow(sub)),2], sub[c(nrow(sub):1),2]), c(lower, upper[length(upper):1]),
border = NA, col = alpha(colours[k], 0.4))
} else{
polygon(c(sub[c(1:nrow(sub)),2], sub[c(nrow(sub):1),2]), c(lower, upper[length(upper):1]),
border = NA, col = alpha(colours[k], 0.2))
}
for(y in unique(OUT[,1])){
sub <- OUT[OUT[,1] == y,]
lower <- sub[,3]-sub[,4]
upper <- sub[,3]+sub[,4]
lines(sub[,2], sub[,3], col = 'white')
points(sub[,2], sub[,3], col = 'white', cex = 0.6, pch = 19)
points(372, mean(sub[,3]), pch = 19, col = alpha(colours[k], 0.7), cex = 1.2)
points(383, mean(sub[which(sub[,2] >= 335 | sub[,2] <= 90),3]), pch = 15, col = alpha(colours[k], 0.7), cex = 1.2)
points(394, mean(sub[which(sub[,2] >= 182 & sub[,2] <= 243),3]), pch = 17, col = alpha(colours[k], 0.7), cex = 1.2)
}
# par(xpd = TRUE)
# legend('topright', pch = c(17,15,19), col = alpha(colours[k], 0.7), bty = 'n',
#        legend = c('Summer rainy', 'Winter rainy', 'Annual'), inset = -.2,
#        title = 'Means')
# legend('bottomright', fill = c(s.rain, w.rain), legend = c('Summer rainy','Winter rainy'),
#        bty = 'n', title = 'Seasons', border = NA, inset = -.2)
abline(v = 367.5, lty = 2)
k <- k+1
}
dev.off()
## single page
pdf('/Users/Avril/Desktop/vars_across_days_with_offset_singlepage.pdf', width = 6.5, height = 8)
par(mar = c(3.1, 4.1, 0.1, 0.1), mfrow = c(4,1))
k <- 1
txt.size <- 1.1
y.names <- c('Greenness','Wetness','Brightness','Surface temperature (deg C)')
for(c in c(2:4,10)){
OUT <- NULL
for(y in unique(occ.dat$off.year)){
sub <- occ.dat[occ.dat$off.year == y,]
for(d in sort(unique(sub$off.doy))){
save <- c(y, d, mean(sub[sub$off.doy == d, c]), sd(sub[sub$off.doy == d, c]))
OUT <- rbind(OUT, save)
}
par(xpd = FALSE)
if(k < 4){
plot(0,0, xlim = c(0,386), ylim = c(min(OUT[,3] - OUT[,4]), max(OUT[,3] + OUT[,4])), col = 'transparent',
xlab = '', ylab = y.names[k], main = '', xaxt = 'n', cex.lab = txt.size, cex.axis = txt.size)
} else{
plot(0,0, xlim = c(0,386), ylim = c(min(OUT[,3] - OUT[,4]), max(OUT[,3] + OUT[,4])), col = 'transparent',
xlab = '', ylab = y.names[k], main = '', xaxt = 'n', cex.lab = txt.size, cex.axis = txt.size)
}
axis(1, at = c(1, 154, 275), labels = c('July 1','December 1','April 1'), cex.lab = txt.size, cex.axis = txt.size)
polygon(x = c(154, 274, 274, 154), y = c(-10, -10, 100, 100), border = NA, col = w.rain)
polygon(x = c(1, 62, 62, 1), y = c(-10, -10, 100, 100), border = NA, col = s.rain)
for(y in unique(OUT[,1])){
sub <- OUT[OUT[,1] == y,]
lower <- sub[,3]-sub[,4]
upper <- sub[,3]+sub[,4]
if(k == 4){
polygon(c(sub[c(1:nrow(sub)),2], sub[c(nrow(sub):1),2]), c(lower, upper[length(upper):1]),
border = NA, col = alpha(colours[k], 0.4))
} else{
polygon(c(sub[c(1:nrow(sub)),2], sub[c(nrow(sub):1),2]), c(lower, upper[length(upper):1]),
border = NA, col = alpha(colours[k], 0.2))
}
for(y in unique(OUT[,1])){
sub <- OUT[OUT[,1] == y,]
lower <- sub[,3]-sub[,4]
upper <- sub[,3]+sub[,4]
lines(sub[,2], sub[,3], col = 'white')
points(sub[,2], sub[,3], col = 'white', cex = 0.6, pch = 19)
points(372, mean(sub[,3]), pch = 19, col = alpha(colours[k], 0.7), cex = 1.2)
points(383, mean(sub[which(sub[,2] >= 335 | sub[,2] <= 90),3]), pch = 15, col = alpha(colours[k], 0.7), cex = 1.2)
points(394, mean(sub[which(sub[,2] >= 182 & sub[,2] <= 243),3]), pch = 17, col = alpha(colours[k], 0.7), cex = 1.2)
}
# par(xpd = TRUE)
# legend('topright', pch = c(17,15,19), col = alpha(colours[k], 0.7), bty = 'n',
#        legend = c('Summer rainy', 'Winter rainy', 'Annual'), inset = -.2,
#        title = 'Means')
# legend('bottomright', fill = c(s.rain, w.rain), legend = c('Summer rainy','Winter rainy'),
#        bty = 'n', title = 'Seasons', border = NA, inset = -.2)
abline(v = 367.5, lty = 2)
k <- k+1
}
dev.off()
## single page
pdf('/Users/Avril/Desktop/vars_across_days_with_offset_singlepage.pdf', width = 6.5, height = 8)
par(mar = c(3.1, 4.1, 0.1, 0.1), mfrow = c(4,1))
k <- 1
txt.size <- 1.1
y.names <- c('Greenness','Wetness','Brightness','Surface temperature (deg C)')
for(c in c(2:4,10)){
OUT <- NULL
for(y in unique(occ.dat$off.year)){
sub <- occ.dat[occ.dat$off.year == y,]
for(d in sort(unique(sub$off.doy))){
save <- c(y, d, mean(sub[sub$off.doy == d, c]), sd(sub[sub$off.doy == d, c]))
OUT <- rbind(OUT, save)
}
par(xpd = FALSE)
if(k < 4){
plot(0,0, xlim = c(0,386), ylim = c(min(OUT[,3] - OUT[,4]), max(OUT[,3] + OUT[,4])), col = 'transparent',
xlab = '', ylab = y.names[k], main = '', xaxt = 'n', cex.lab = txt.size, cex.axis = txt.size)
} else{
plot(0,0, xlim = c(0,386), ylim = c(min(OUT[,3] - OUT[,4]), max(OUT[,3] + OUT[,4])), col = 'transparent',
xlab = '', ylab = y.names[k], main = '', xaxt = 'n', cex.lab = txt.size, cex.axis = txt.size)
}
axis(1, at = c(1, 154, 275), labels = c('July 1','December 1','April 1'), cex.lab = txt.size, cex.axis = txt.size)
polygon(x = c(154, 274, 274, 154), y = c(-10, -10, 100, 100), border = NA, col = w.rain)
polygon(x = c(1, 62, 62, 1), y = c(-10, -10, 100, 100), border = NA, col = s.rain)
for(y in unique(OUT[,1])){
sub <- OUT[OUT[,1] == y,]
lower <- sub[,3]-sub[,4]
upper <- sub[,3]+sub[,4]
if(k == 4){
polygon(c(sub[c(1:nrow(sub)),2], sub[c(nrow(sub):1),2]), c(lower, upper[length(upper):1]),
border = NA, col = alpha(colours[k], 0.4))
} else{
polygon(c(sub[c(1:nrow(sub)),2], sub[c(nrow(sub):1),2]), c(lower, upper[length(upper):1]),
border = NA, col = alpha(colours[k], 0.2))
}
for(y in unique(OUT[,1])){
sub <- OUT[OUT[,1] == y,]
lower <- sub[,3]-sub[,4]
upper <- sub[,3]+sub[,4]
lines(sub[,2], sub[,3], col = 'white')
points(sub[,2], sub[,3], col = 'white', cex = 0.6, pch = 19)
points(372, mean(sub[,3]), pch = 19, col = alpha(colours[k], 0.7), cex = 1.2)
points(383, mean(sub[which(sub[,2] >= 335 | sub[,2] <= 90),3]), pch = 15, col = alpha(colours[k], 0.7), cex = 1.2)
points(394, mean(sub[which(sub[,2] >= 182 & sub[,2] <= 243),3]), pch = 17, col = alpha(colours[k], 0.7), cex = 1.2)
}
# par(xpd = TRUE)
# legend('topright', pch = c(17,15,19), col = alpha(colours[k], 0.7), bty = 'n',
#        legend = c('Summer rainy', 'Winter rainy', 'Annual'), inset = -.2,
#        title = 'Means')
# legend('bottomright', fill = c(s.rain, w.rain), legend = c('Summer rainy','Winter rainy'),
#        bty = 'n', title = 'Seasons', border = NA, inset = -.2)
abline(v = 367.5, lty = 2, lwd = 0.75, col = 'darkgrey')
k <- k+1
}
dev.off()
## single page
pdf('/Users/Avril/Desktop/vars_across_days_with_offset_singlepage.pdf', width = 6.5, height = 8)
par(mar = c(3.1, 4.1, 0.1, 0.1), mfrow = c(4,1))
k <- 1
txt.size <- 1.1
y.names <- c('Greenness','Wetness','Brightness','Surface temperature (deg C)')
for(c in c(2:4,10)){
OUT <- NULL
for(y in unique(occ.dat$off.year)){
sub <- occ.dat[occ.dat$off.year == y,]
for(d in sort(unique(sub$off.doy))){
save <- c(y, d, mean(sub[sub$off.doy == d, c]), sd(sub[sub$off.doy == d, c]))
OUT <- rbind(OUT, save)
}
par(xpd = FALSE)
if(k < 4){
plot(0,0, xlim = c(0,386), ylim = c(min(OUT[,3] - OUT[,4]), max(OUT[,3] + OUT[,4])), col = 'transparent',
xlab = '', ylab = y.names[k], main = '', xaxt = 'n', cex.lab = txt.size, cex.axis = txt.size)
} else{
plot(0,0, xlim = c(0,386), ylim = c(min(OUT[,3] - OUT[,4]), max(OUT[,3] + OUT[,4])), col = 'transparent',
xlab = '', ylab = y.names[k], main = '', xaxt = 'n', cex.lab = txt.size, cex.axis = txt.size)
}
axis(1, at = c(1, 154, 275), labels = c('July 1','December 1','April 1'), cex.lab = txt.size, cex.axis = txt.size)
polygon(x = c(154, 274, 274, 154), y = c(-10, -10, 100, 100), border = NA, col = w.rain)
polygon(x = c(1, 62, 62, 1), y = c(-10, -10, 100, 100), border = NA, col = s.rain)
for(y in unique(OUT[,1])){
sub <- OUT[OUT[,1] == y,]
lower <- sub[,3]-sub[,4]
upper <- sub[,3]+sub[,4]
if(k == 4){
polygon(c(sub[c(1:nrow(sub)),2], sub[c(nrow(sub):1),2]), c(lower, upper[length(upper):1]),
border = NA, col = alpha(colours[k], 0.4))
} else{
polygon(c(sub[c(1:nrow(sub)),2], sub[c(nrow(sub):1),2]), c(lower, upper[length(upper):1]),
border = NA, col = alpha(colours[k], 0.2))
}
for(y in unique(OUT[,1])){
sub <- OUT[OUT[,1] == y,]
lower <- sub[,3]-sub[,4]
upper <- sub[,3]+sub[,4]
lines(sub[,2], sub[,3], col = 'white')
points(sub[,2], sub[,3], col = 'white', cex = 0.6, pch = 19)
points(372, mean(sub[,3]), pch = 19, col = alpha(colours[k], 0.7), cex = 1.2)
points(383, mean(sub[which(sub[,2] >= 335 | sub[,2] <= 90),3]), pch = 15, col = alpha(colours[k], 0.7), cex = 1.2)
points(394, mean(sub[which(sub[,2] >= 182 & sub[,2] <= 243),3]), pch = 17, col = alpha(colours[k], 0.7), cex = 1.2)
}
# par(xpd = TRUE)
# legend('topright', pch = c(17,15,19), col = alpha(colours[k], 0.7), bty = 'n',
#        legend = c('Summer rainy', 'Winter rainy', 'Annual'), inset = -.2,
#        title = 'Means')
# legend('bottomright', fill = c(s.rain, w.rain), legend = c('Summer rainy','Winter rainy'),
#        bty = 'n', title = 'Seasons', border = NA, inset = -.2)
abline(v = 367.5, lty = 2, lwd = 0.75, col = 'grey20')
k <- k+1
}
dev.off()
tc.dat <- read.csv('/Users/Avril/Documents/krat_remote_sensing/intermediate_data/occ_and_adj_cells_12monthinterval_means_seasoneq.csv')
## single page
pdf('/Users/Avril/Desktop/vars_across_days_with_offset_singlepage.pdf', width = 6.5, height = 8.5)
par(mar = c(3.1, 4.1, 0.1, 0.1), mfrow = c(4,1))
k <- 1
txt.size <- 1.1
y.names <- c('Greenness','Wetness','Brightness','Surface temperature (deg C)')
for(c in c(2:4,10)){
OUT <- NULL
for(y in unique(occ.dat$off.year)){
sub <- occ.dat[occ.dat$off.year == y,]
for(d in sort(unique(sub$off.doy))){
save <- c(y, d, mean(sub[sub$off.doy == d, c]), sd(sub[sub$off.doy == d, c]))
OUT <- rbind(OUT, save)
}
par(xpd = FALSE)
if(k < 4){
plot(0,0, xlim = c(0,386), ylim = c(min(OUT[,3] - OUT[,4]), max(OUT[,3] + OUT[,4])), col = 'transparent',
xlab = '', ylab = y.names[k], main = '', xaxt = 'n', cex.lab = txt.size, cex.axis = txt.size)
} else{
plot(0,0, xlim = c(0,386), ylim = c(min(OUT[,3] - OUT[,4]), max(OUT[,3] + OUT[,4])), col = 'transparent',
xlab = '', ylab = y.names[k], main = '', xaxt = 'n', cex.lab = txt.size, cex.axis = txt.size)
}
axis(1, at = c(1, 154, 275), labels = c('July 1','December 1','April 1'), cex.lab = txt.size, cex.axis = txt.size)
polygon(x = c(154, 274, 274, 154), y = c(-10, -10, 100, 100), border = NA, col = w.rain)
polygon(x = c(1, 62, 62, 1), y = c(-10, -10, 100, 100), border = NA, col = s.rain)
for(y in unique(OUT[,1])){
sub <- OUT[OUT[,1] == y,]
lower <- sub[,3]-sub[,4]
upper <- sub[,3]+sub[,4]
if(k == 4){
polygon(c(sub[c(1:nrow(sub)),2], sub[c(nrow(sub):1),2]), c(lower, upper[length(upper):1]),
border = NA, col = alpha(colours[k], 0.4))
} else{
polygon(c(sub[c(1:nrow(sub)),2], sub[c(nrow(sub):1),2]), c(lower, upper[length(upper):1]),
border = NA, col = alpha(colours[k], 0.2))
}
for(y in unique(OUT[,1])){
sub <- OUT[OUT[,1] == y,]
lower <- sub[,3]-sub[,4]
upper <- sub[,3]+sub[,4]
lines(sub[,2], sub[,3], col = 'white')
points(sub[,2], sub[,3], col = 'white', cex = 0.6, pch = 19)
points(372, mean(sub[,3]), pch = 19, col = alpha(colours[k], 0.7), cex = 1.2)
points(383, mean(sub[which(sub[,2] >= 335 | sub[,2] <= 90),3]), pch = 15, col = alpha(colours[k], 0.7), cex = 1.2)
points(394, mean(sub[which(sub[,2] >= 182 & sub[,2] <= 243),3]), pch = 17, col = alpha(colours[k], 0.7), cex = 1.2)
}
# par(xpd = TRUE)
# legend('topright', pch = c(17,15,19), col = alpha(colours[k], 0.7), bty = 'n',
#        legend = c('Summer rainy', 'Winter rainy', 'Annual'), inset = -.2,
#        title = 'Means')
# legend('bottomright', fill = c(s.rain, w.rain), legend = c('Summer rainy','Winter rainy'),
#        bty = 'n', title = 'Seasons', border = NA, inset = -.2)
abline(v = 367.5, lty = 2, lwd = 0.75, col = 'grey20')
k <- k+1
}
dev.off()
